structure = {
    "1_Computer_Networks_and_the_Internet": {
        "1.1_What_is_the_Internet": [
            "1.1.1_A_Nuts-and-Bolts_Description",
            "1.1.2_A_Services_Description",
            "1.1.3_What_is_a_Protocol"
        ],
        "1.2_The_Network_Edge": [
            "1.2.1_Access_Networks",
            "1.2.2_Physical_Media"
        ],
        "1.3_The_Network_Core": [
            "1.3.1_Packet_Switching",
            "1.3.2_Circuit_Switching",
            "1.3.3_A_Network_of_Networks"
        ],
        "1.4_Delay_Loss_and_Throughput_in_Packet-Switched_Networks": [
            "1.4.1_Overview_of_Delay_in_Packet-Switched_Networks",
            "1.4.2_Queuing_Delay_and_Packet_Loss",
            "1.4.3_End-to-End_Delay",
            "1.4.4_Throughput_in_Computer_Networks"
        ],
        "1.5_Protocol_Layers_and_Their_Service_Models": [
            "1.5.1_Layered_Architecture",
            "1.5.2_Encapsulation"
        ],
        "1.6_Networks_Under_Attack": [],
        "1.7_History_of_Computer_Networking_and_the_Internet": [
            "1.7.1_The_Development_of_Packet_Switching_1961-1972",
            "1.7.2_Proprietary_Networks_and_Internetworking_1972-1980",
            "1.7.3_A_Proliferation_of_Networks_1980-1990",
            "1.7.4_The_Internet_Explosion_The_1990s",
            "1.7.5_The_New_Millennium"
        ],
        "1.8_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Wireshark_Lab": [],
        "Interview_Leonard_Kleinrock": []
    },
    "2_Application_Layer": {
        "2.1_Principles_of_Network_Applications": [
            "2.1.1_Network_Application_Architectures",
            "2.1.2_Processes_Communicating",
            "2.1.3_Transport_Services_Available_to_Applications",
            "2.1.4_Transport_Services_Provided_by_the_Internet",
            "2.1.5_Application-Layer_Protocols",
            "2.1.6_Network_Applications_Covered_in_This_Book"
        ],
        "2.2_The_Web_and_HTTP": [
            "2.2.1_Overview_of_HTTP",
            "2.2.2_Non-Persistent_and_Persistent_Connections",
            "2.2.3_HTTP_Message_Format",
            "2.2.4_User-Server_Interaction_Cookies",
            "2.2.5_Web_Caching"
        ],
        "2.3_Electronic_Mail_in_the_Internet": [
            "2.3.1_SMTP",
            "2.3.2_Comparison_with_HTTP",
            "2.3.3_Mail_Message_Formats",
            "2.3.4_Mail_Access_Protocols"
        ],
        "2.4_DNS_The_Internet's_Directory_Service": [
            "2.4.1_Services_Provided_by_DNS",
            "2.4.2_Overview_of_How_DNS_Works",
            "2.4.3_DNS_Records_and_Messages"
        ],
        "2.5_Peer-to-Peer_Applications": [
            "2.5.1_P2P_File_Distribution"
        ],
        "2.6_Video_Streaming_and_Content_Distribution_Networks": [
            "2.6.1_Internet_Video",
            "2.6.2_HTTP_Streaming_and_DASH",
            "2.6.3_Content_Distribution_Networks",
            "2.6.4_Case_Studies_Netflix_YouTube_and_Kankan"
        ],
        "2.7_Socket_Programming_Creating_Network_Applications": [
            "2.7.1_Socket_Programming_with_UDP",
            "2.7.2_Socket_Programming_with_TCP"
        ],
        "2.8_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Socket_Programming_Assignments": [],
        "Wireshark_Labs_HTTP_DNS": [],
        "Interview_Marc_Andreessen": []
    },
    "3_Transport_Layer": {
        "3.1_Introduction_and_Transport-Layer_Services": [
            "3.1.1_Relationship_Between_Transport_and_Network_Layers",
            "3.1.2_Overview_of_the_Transport_Layer_in_the_Internet"
        ],
        "3.2_Multiplexing_and_Demultiplexing": [],
        "3.3_Connectionless_Transport_UDP": [
            "3.3.1_UDP_Segment_Structure",
            "3.3.2_UDP_Checksum"
        ],
        "3.4_Principles_of_Reliable_Data_Transfer": [
            "3.4.1_Building_a_Reliable_Data_Transfer_Protocol",
            "3.4.2_Pipelined_Reliable_Data_Transfer_Protocols",
            "3.4.3_Go-Back-N_GBN",
            "3.4.4_Selective_Repeat_SR"
        ],
        "3.5_Connection-Oriented_Transport_TCP": [
            "3.5.1_The_TCP_Connection",
            "3.5.2_TCP_Segment_Structure",
            "3.5.3_Round-Trip_Time_Estimation_and_Timeout",
            "3.5.4_Reliable_Data_Transfer",
            "3.5.5_Flow_Control",
            "3.5.6_TCP_Connection_Management"
        ],
        "3.6_Principles_of_Congestion_Control": [
            "3.6.1_The_Causes_and_the_Costs_of_Congestion",
            "3.6.2_Approaches_to_Congestion_Control"
        ],
        "3.7_TCP_Congestion_Control": [
            "3.7.1_Fairness",
            "3.7.2_Explicit_Congestion_Notification_ECN"
        ],
        "3.8_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Programming_Assignments": [],
        "Wireshark_Labs_Exploring_TCP_UDP": [],
        "Interview_Van_Jacobson": []
    },
    "4_The_Network_Layer_Data_Plane": {
        "4.1_Overview_of_Network_Layer": [
            "4.1.1_Forwarding_and_Routing_The_Network_Data_and_Control_Planes",
            "4.1.2_Network_Service_Models"
        ],
        "4.2_What's_Inside_a_Router": [
            "4.2.1_Input_Port_Processing_and_Destination-Based_Forwarding",
            "4.2.2_Switching",
            "4.2.3_Output_Port_Processing",
            "4.2.4_Where_Does_Queuing_Occur",
            "4.2.5_Packet_Scheduling"
        ],
        "4.3_The_Internet_Protocol_IP_IPv4_Addressing_IPv6_and_More": [
            "4.3.1_IPv4_Datagram_Format",
            "4.3.2_IPv4_Datagram_Fragmentation",
            "4.3.3_IPv4_Addressing",
            "4.3.4_Network_Address_Translation_NAT",
            "4.3.5_IPv6"
        ],
        "4.4_Generalized_Forwarding_and_SDN": [
            "4.4.1_Match",
            "4.4.2_Action",
            "4.4.3_OpenFlow_Examples_of_Match-plus-action_in_Action"
        ],
        "4.5_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Wireshark_Lab": [],
        "Interview_Vinton_G_Cerf": []
    },
    "5_The_Network_Layer_Control_Plane": {
        "5.1_Introduction": [],
        "5.2_Routing_Algorithms": [
            "5.2.1_The_Link-State_LS_Routing_Algorithm",
            "5.2.2_The_Distance-Vector_DV_Routing_Algorithm"
        ],
        "5.3_Intra-AS_Routing_in_the_Internet_OSPF": [],
        "5.4_Routing_Among_the_ISPs_BGP": [
            "5.4.1_The_Role_of_BGP",
            "5.4.2_Advertising_BGP_Route_Information",
            "5.4.3_Determining_the_Best_Routes",
            "5.4.4_IP-Anycast",
            "5.4.5_Routing_Policy",
            "5.4.6_Putting_the_Pieces_Together_Obtaining_Internet_Presence"
        ],
        "5.5_The_SDN_Control_Plane": [
            "5.5.1_The_SDN_Control_Plane_SDN_Controller_and_SDN_Control_Applications",
            "5.5.2_OpenFlow_Protocol",
            "5.5.3_Data_and_Control_Plane_Interaction_An_Example",
            "5.5.4_SDN_Past_and_Future"
        ],
        "5.6_ICMP_The_Internet_Control_Message_Protocol": [],
        "5.7_Network_Management_and_SNMP": [
            "5.7.1_The_Network_Management_Framework",
            "5.7.2_The_Simple_Network_Management_Protocol_SNMP"
        ],
        "5.8_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Socket_Programming_Assignment": [],
        "Programming_Assignment": [],
        "Wireshark_Lab": [],
        "Interview_Jennifer_Rexford": []
    },
    "6_The_Link_Layer_and_LANs": {
        "6.1_Introduction_to_the_Link_Layer": [
            "6.1.1_The_Services_Provided_by_the_Link_Layer",
            "6.1.2_Where_is_the_Link_Layer_Implemented"
        ],
        "6.2_Error-Detection_and-Correction_Techniques": [
            "6.2.1_Parity_Checks",
            "6.2.2_Checksumming_Methods",
            "6.2.3_Cyclic_Redundancy_Check_CRC"
        ],
        "6.3_Multiple_Access_Links_and_Protocols": [
            "6.3.1_Channel_Partitioning_Protocols",
            "6.3.2_Random_Access_Protocols",
            "6.3.3_Taking-Turns_Protocols",
            "6.3.4_DOCSIS_The_Link-Layer_Protocol_for_Cable_Internet_Access"
        ],
        "6.4_Switched_Local_Area_Networks": [
            "6.4.1_Link-Layer_Addressing_and_ARP",
            "6.4.2_Ethernet",
            "6.4.3_Link-Layer_Switches",
            "6.4.4_Virtual_Local_Area_Networks_VLANs"
        ],
        "6.5_Link_Virtualization_A_Network_as_a_Link_Layer": [
            "6.5.1_Multiprotocol_Label_Switching_MPLS"
        ],
        "6.6_Data_Center_Networking": [],
        "6.7_Retrospective_A_Day_in_the_Life_of_a_Web_Page_Request": [
            "6.7.1_Getting_Started_DHCP_UDP_IP_and_Ethernet",
            "6.7.2_Still_Getting_Started_DNS_and_ARP",
            "6.7.3_Still_Getting_Started_Intra-Domain_Routing_to_the_DNS_Server",
            "6.7.4_Web_Client-Server_Interaction_TCP_and_HTTP"
        ],
        "6.8_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Wireshark_Lab": [],
        "Interview_Simon_S_Lam": []
    },
    "7_Wireless_and_Mobile_Networks": {
        "7.1_Introduction": [],
        "7.2_Wireless_Links_and_Network_Characteristics": [
            "7.2.1_CDMA"
        ],
        "7.3_WiFi_802.11_Wireless_LANs": [
            "7.3.1_The_802.11_Architecture",
            "7.3.2_The_802.11_MAC_Protocol",
            "7.3.3_The_IEEE_802.11_Frame",
            "7.3.4_Mobility_in_the_Same_IP_Subnet",
            "7.3.5_Advanced_Features_in_802.11",
            "7.3.6_Personal_Area_Networks_Bluetooth_and_Zigbee"
        ],
        "7.4_Cellular_Internet_Access": [
            "7.4.1_An_Overview_of_Cellular_Network_Architecture",
            "7.4.2_3G_Cellular_Data_Networks_Extending_the_Internet_to_Cellular_Subscribers",
            "7.4.3_On_to_4G_LTE"
        ],
        "7.5_Mobility_Management_Principles": [
            "7.5.1_Addressing",
            "7.5.2_Routing_to_a_Mobile_Node"
        ],
        "7.6_Mobile_IP": [],
        "7.7_Managing_Mobility_in_Cellular_Networks": [
            "7.7.1_Routing_Calls_to_a_Mobile_User",
            "7.7.2_Handoffs_in_GSM"
        ],
        "7.8_Wireless_and_Mobility_Impact_on_Higher-Layer_Protocols": [],
        "7.9_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Wireshark_Lab": [],
        "Interview_Deborah_Estrin": []
    },
    "8_Security_in_Computer_Networks": {
        "8.1_What_is_Network_Security": [],
        "8.2_Principles_of_Cryptography": [
            "8.2.1_Symmetric_Key_Cryptography",
            "8.2.2_Public_Key_Encryption"
        ],
        "8.3_Message_Integrity_and_Digital_Signatures": [
            "8.3.1_Cryptographic_Hash_Functions",
            "8.3.2_Message_Authentication_Code",
            "8.3.3_Digital_Signatures"
        ],
        "8.4_End-Point_Authentication": [
            "8.4.1_Authentication_Protocol_ap1.0",
            "8.4.2_Authentication_Protocol_ap2.0",
            "8.4.3_Authentication_Protocol_ap3.0",
            "8.4.4_Authentication_Protocol_ap3.1",
            "8.4.5_Authentication_Protocol_ap4.0"
        ],
        "8.5_Securing_E-Mail": [
            "8.5.1_Secure_E-Mail",
            "8.5.2_PGP"
        ],
        "8.6_Securing_TCP_Connections_SSL": [
            "8.6.1_The_Big_Picture",
            "8.6.2_A_More_Complete_Picture"
        ],
        "8.7_Network-Layer_Security_IPsec_and_Virtual_Private_Networks": [
            "8.7.1_IPsec_and_Virtual_Private_Networks_VPNs",
            "8.7.2_The_AH_and_ESP_Protocols",
            "8.7.3_Security_Associations",
            "8.7.4_The_IPsec_Datagram",
            "8.7.5_IKE_Key_Management_in_IPsec"
        ],
        "8.8_Securing_Wireless_LANs": [
            "8.8.1_Wired_Equivalent_Privacy_WEP",
            "8.8.2_IEEE_802.11i"
        ],
        "8.9_Operational_Security_Firewalls_and_Intrusion_Detection_Systems": [
            "8.9.1_Firewalls",
            "8.9.2_Intrusion_Detection_Systems"
        ],
        "8.10_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Wireshark_Lab": [],
        "IPsec_Lab": [],
        "Interview_Steven_M_Bellovin": []
    },
    "9_Multimedia_Networking": {
        "9.1_Multimedia_Networking_Applications": [
            "9.1.1_Properties_of_Video",
            "9.1.2_Properties_of_Audio",
            "9.1.3_Types_of_Multimedia_Network_Applications"
        ],
        "9.2_Streaming_Stored_Video": [
            "9.2.1_UDP_Streaming",
            "9.2.2_HTTP_Streaming"
        ],
        "9.3_Voice-over-IP": [
            "9.3.1_Limitations_of_the_Best-Effort_IP_Service",
            "9.3.2_Removing_Jitter_at_the_Receiver_for_Audio",
            "9.3.3_Recovering_from_Packet_Loss",
            "9.3.4_Case_Study_VoIP_with_Skype"
        ],
        "9.4_Protocols_for_Real-Time_Conversational_Applications": [
            "9.4.1_RTP",
            "9.4.2_SIP"
        ],
        "9.5_Network_Support_for_Multimedia": [
            "9.5.1_Dimensioning_Best-Effort_Networks",
            "9.5.2_Providing_Multiple_Classes_of_Service",
            "9.5.3_Diffserv",
            "9.5.4_Per-Connection_Quality-of-Service_QoS_Guarantees_Resource_Reservation_and_Call_Admission"
        ],
        "9.6_Summary": [],
        "Homework_Problems_and_Questions": [],
        "Programming_Assignment": [],
        "Interview_Henning_Schulzrinne": []
    }
}



import os
from typing import Dict, Any

def create_directories_and_files(
        base_path: str, 
        structure: Dict[str, Any], 
        readme_file, 
        parent_path: str = "", 
        level: int = 1
    ):
    heading = "#" * level

    for key, value in structure.items():
        current_path = os.path.join(base_path, key.replace(" ", "_").replace("/", "_").replace("-", "_"))

        # 创建目录
        os.makedirs(current_path, exist_ok=True)

        # 在README中添加章节标题
        if parent_path:
            readme_file.write(f"{heading} {parent_path}/{key}\n\n")
        else:
            readme_file.write(f"{heading} {key}\n\n")

        # 递归调用创建子目录和文件
        if isinstance(value, dict) and value:
            create_directories_and_files(
                current_path, 
                value, 
                readme_file, 
                parent_path + "/" + key if parent_path else key, 
                level + 1
            )
        elif isinstance(value, list) and value:
            for idx, item in enumerate(value):
                if isinstance(item, dict) and item:
                    create_directories_and_files(
                        current_path, 
                        item, 
                        readme_file, 
                        parent_path + "/" + key if parent_path else key, 
                        level + 1
                    )
                else:
                    item = f"{idx:02d}_{item}"
                    file_name = item.replace(" ", "_").replace("/", "_").replace("-", "_") + ".py"
                    file_path = os.path.join(current_path, file_name)
                    with open(file_path, 'w', encoding='utf-8') as file:
                        file.write(f"# {item}\n\n")
                        file.write(f'"""\nLecture: {parent_path}/{key}\nContent: {item}\n"""\n\n')

                    # 在README中添加文件链接
                    item_clean = item.replace(" ", "_").replace("/", "_").replace("-", "_")
                    parent_clean = parent_path.replace(" ", "_").replace("/", "_").replace("-", "_")
                    key_clean = key.replace(" ", "_").replace("/", "_").replace("-", "_")
                    readme_file.write(f"- [{item}](./{parent_clean}/{key_clean}/{item_clean}.py)\n")
                    
                    
                    file_name = item.replace(" ", "_").replace("/", "_").replace("-", "_") + ".md"
                    file_path = os.path.join(current_path, file_name)
                    with open(file_path, 'w', encoding='utf-8') as file:
                        file.write(f"# {item}\n\n")
                        file.write(f'"""\nLecture: {parent_path}/{key}\nContent: {item}\n"""\n\n')

                    # 在README中添加文件链接
                    item_clean = item.replace(" ", "_").replace("/", "_").replace("-", "_")
                    parent_clean = parent_path.replace(" ", "_").replace("/", "_").replace("-", "_")
                    key_clean = key.replace(" ", "_").replace("/", "_").replace("-", "_")
                    readme_file.write(f"- [{item}](./{parent_clean}/{key_clean}/{item_clean}.md)\n")
        else:
            # 创建文件并写入初始内容
            file_name = key.replace(" ", "_").replace("/", "_").replace("-", "_") + ".py"
            file_path = os.path.join(current_path, file_name)
            with open(file_path, 'w', encoding='utf-8') as file:
                file.write(f"# {key}\n\n")
                file.write(f'"""\nLecture: {parent_path}/{key}\nContent: {key}\n"""\n\n')

            # 在README中添加文件链接
            parent_clean = parent_path.replace(" ", "_").replace("/", "_").replace("-", "_")
            key_clean = key.replace(" ", "_").replace("/", "_").replace("-", "_")
            readme_file.write(f"- [{key}](./{parent_clean}/{key_clean}/{file_name})\n")
            
            
            file_name = key.replace(" ", "_").replace("/", "_").replace("-", "_") + ".md"
            file_path = os.path.join(current_path, file_name)
            with open(file_path, 'w', encoding='utf-8') as file:
                file.write(f"# {key}\n\n")
                file.write(f'"""\nLecture: {parent_path}/{key}\nContent: {key}\n"""\n\n')

            # 在README中添加文件链接
            parent_clean = parent_path.replace(" ", "_").replace("/", "_").replace("-", "_")
            key_clean = key.replace(" ", "_").replace("/", "_").replace("-", "_")
            readme_file.write(f"- [{key}](./{parent_clean}/{key_clean}/{file_name})\n")

        # 添加空行以分隔不同的章节
        readme_file.write("\n")

def main():
    root_dir = './'
    # 创建根目录
    os.makedirs(root_dir, exist_ok=True)

    # 创建 README.md 文件
    with open(os.path.join(root_dir, "README.md"), 'w', encoding='utf-8') as readme_file:
        readme_file.write("# Computer Network\n\n")
        readme_file.write("这是一个关于Computer Network的目录结构。\n\n")
        create_directories_and_files(root_dir, structure, readme_file)

    print("目录和文件结构已生成，并创建 README.md 文件。")

if __name__ == "__main__":
    main()